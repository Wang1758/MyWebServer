# Makefile编写规则
### 1. 语法规则
```
目标 ... : 依赖 ...
	命令1
	命令2
	. . .
```

1、**目标**即要生成的文件。如果目标文件的更新时间晚于**依赖**文件更新时间，则说明依赖文件没有改动，目标文件不需要重新编译。否则会进行重新编译并更新目标文件。
2、默认情况下Makefile的第一个目标为终极目标。
3、依赖：即目标文件由哪些文件生成。
4、命令：即通过执行命令由依赖文件生成目标文件。注意每条命令之前必须有一个tab(此文档编辑器默认是空格，复制下来的代码需要把命令代码的缩进改为tab制表符)保持缩进，这是语法要求（会有一些编辑工具默认tab为4个空格，会造成Makefile语法错误）。
5、all：Makefile文件默认只生成第一个目标文件即完成编译，但是我们可以通过all 指定所需要生成的目标文件。例如下面的例子。
all是第一个目标，target1 target2 target3被列为all的以来
```
all: target1 target2 target3
target1:
# 编译规则1
target2:
# 编译规则2
target3:
# 编译规则3
```

### 2. 变量
##### 2.1 变量定义与取值
**$符号**表示取变量的值，当变量名多于一个字符时，使用()
```
$^ 表示所有的依赖文件
$@ 表示生成的目标文件
$< 代表第一个依赖文件
```

##### 2.2 变量赋值
使用“=”对变量赋值，变量的值是整个Makefile中最后被指定的值
```
VIR_A = A
VIR_B = $(VIR_A) B  // AA B
VIR_A = AA
```
使用“:=”对变量直接赋值，赋予当前位置的值
```
VIR_A := A
VIR_B := $(VIR_A) B // A B
VIR_A := AA
```
使用“?=”表示如果该变量没有被赋值，则赋值成等号后面的值
使用“+=”将等号后面的值添加到变量的后面

##### 2.3 预定义变量
CC: c编译器的名称

##### 2.4 函数
匹配目录下所有.c文件，并赋值给SRC
取出SRC中的值，将.c更换为.o，然后赋值给OBJ变量
```
SRC = $(wildcard ./*.c)
OBJ = $(patsubst %.c, %.o, $(SRC))
```