## 日志系统
#### 1. 单例模式
   单例模式涉及到一个单一的类，该类负责创建自己的对象，同时确保只有单个对象被创建。这个类提供了一种访问其唯一对象的方式，可以直接访问而不需要实例化该类的对象

1.1 单例模式的实现方式
* **饿汉式**：只有该类被加载并调用getInstance的时候才会初始化这个单例。**在C++11之后，不需要加锁，直接使用函数内的局部静态对象**
* **饱汉模式**：在程序运行时就初始化单例对象。**不需要加锁就可以保证线程安全**

#### 2. 异步日志
2.1 日志分类
* **同步日志**：日志写入函数与工作线程串行执行，由于涉及到I/O操作，当单条日志比较大的时候，同步模式会阻塞整个处理流程，服务器所能处理的并发能力将有所下降，尤其是在峰值的时候，写日志可能成为系统的瓶颈。
* **异步日志**：将所写的日志内容先存入阻塞队列中，写线程从阻塞队列中取出内容，写入日志

2.2 阻塞队列
* 通过一个双向队列实现，实现了队列常用的方法
* 通过加锁来保证线程安全，该阻塞队列中所有方法都是线程安全的
* 使用消费者生产者模型实现push和pop操作，消费者条件变量保证队列不空，生产者条件变量保证队列不满

#### 3. 日志系统的运行流程
1. 第一次调用Instance()方法时创建静态单例对象，之后则直接获取该对象
2. 调用日志对象的init()方法初始化日志对象，设置日志允许写入的等级、路径、后缀、队列大小，队列大小为0时该日志系统为同步日志。若为异步日志则启动该日志的写线程，等待队列非空时再进行写入文件操作
3. 其他线程通过四个宏定义接口来将日志信息写入文件，该接口将通过内部的write方法将信息直接写入文件中,在异步模式下将放入队列中

#### 4. 日志系统的分级与分文件
4.1 分级
* **Debug**：0，调试代码时的输出，在系统实际运行时，一般不使用。
* **Info**：1，报告系统当前的状态，当前执行的流程或接收的信息等。
* **Warn**：2，这种警告与调试时终端的warning类似，同样是调试代码时使用。
* **Error**：3，输出系统的错误信息

4.2 分文件
* **按天分**：日志写入前会判断当前today是否为创建日志的时间，若为创建日志时间，则写入日志，否则按当前时间创建新的log文件，更新创建时间和行数。
* **分行数**：日志写入前会判断行数是否超过最大行限制，若超过，则在当前日志的末尾加lineCount / MAX_LOG_LINES为后缀创建新的log文件。